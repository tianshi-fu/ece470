clear
clc

S = [0.00 0.00; 0.00 0.00; -1.00 -1.00; 2.00 2.00; 0.00 2.00; 0.00 0.00];
M = [-1.00 0.00 0.00 2.00; 0.00 0.00 -1.00 -4.00; 0.00 -1.00 0.00 0.00; 0.00 0.00 0.00 1.00];
p_robot = [0.00 0.00 2.00 2.00; 0.00 -2.00 -2.00 -4.00; 0.00 0.00 0.00 0.00];
r_robot = [0.90 0.90 0.90 0.90];
p_obstacle = [-2.63 -8.58 1.31 5.62 2.78 -9.17 3.15 -5.90 -3.57 -9.46 -5.62 6.08 -7.12 6.73 0.69 -5.64 -4.05 -4.39 9.73 7.56 -1.75 2.31 -2.08 8.81; 5.80 -9.40 1.08 -1.92 2.30 -7.66 -3.96 -6.42 8.86 -5.68 7.37 -8.36 -1.06 7.93 -3.30 -6.42 4.56 5.03 -6.14 4.22 -0.51 4.21 -9.22 3.53; -9.47 3.70 4.34 9.28 -7.77 1.24 2.94 -3.18 7.75 3.62 -7.80 -7.48 7.23 -4.81 -5.45 -8.46 -8.35 -0.94 -8.00 7.36 3.25 7.48 -1.88 2.73];
r_obstacle = [1.14 3.32 1.10 1.17 3.65 4.76 1.19 4.56 2.74 0.59 4.63 4.07 4.95 0.92 2.28 1.72 2.11 1.93 2.01 2.10 1.36 0.52 3.50 1.88];
theta = [-0.48 2.19 0.36 -0.64 2.70 1.01 -0.14 2.24 0.40 2.36 -2.56 1.95; -2.29 -0.24 0.66 2.54 -2.91 1.80 -2.52 3.02 3.11 -1.92 1.74 -1.50];

S1 = S(:,1);
S2 = S(:,2);


for i = 1:12
thetac = theta(:,i);
p1 = p_robot(:,1);
p2 = p_robot(:,2);
p3 = expm(ssV(S1,thetac(1)))*[p_robot(:,3);1];
p4 = expm(ssV(S1,thetac(1)))*expm(ssV(S2,thetac(2)))*[p_robot(:,4);1];

p = [p1 p2 p3(1:3) p4(1:3)];

combo = combnk(1:4,2);
[ncombo,~]=size(combo);

for x = 1:ncombo
    d_s(x) = norm(p(:,combo(x,1))-p(:,combo(x,2)))-0.9-0.9;
end


for y = 1:4
    for z = 1:24
    d_o(y,z) = norm(p(:,y)-p_obstacle(:,z))-0.9-r_obstacle(z);    
    end
end

if min(d_s)<=0 || min(d_o(:))<=0
    c(i) = 1;
else
    c(i) = 0;    
end

end

disp(mat2str(c,4))