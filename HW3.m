clear
clc

S = [0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000; 0.00000000 0.00000000 -1.00000000 0.00000000 0.00000000 0.00000000; 0.00000000 0.00000000 0.00000000 1.00000000 0.00000000 -1.00000000; 1.00000000 1.00000000 2.00000000 -4.00000000 1.00000000 6.00000000; 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000; 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000];
M = [0.00000000 0.00000000 -1.00000000 0.00000000; 1.00000000 0.00000000 0.00000000 -6.00000000; 0.00000000 -1.00000000 0.00000000 0.00000000; 0.00000000 0.00000000 0.00000000 1.00000000];
theta = [-1.67099548 1.41345770 -2.49288935 2.09981279 0.58409095 2.54873236 -1.69656154 -2.61768100 1.71597400 2.30598732 3.03001224 -2.55899102 -2.06330175 1.97657879 -0.58686563 -1.26740647 -1.67420271 1.36774661; 2.49204590 -1.70528331 -1.44398101 1.37287175 1.45572101 -2.94517076 -1.04452925 1.06965640 -1.26348003 0.21577337 -0.64853559 3.06491014 2.12619068 2.40418611 -0.98314058 1.29715184 2.84035290 -0.15655851; 0.29215914 0.25691039 -3.07295524 -2.75688268 1.43466879 -0.26631344 -2.07540659 -3.05691555 0.39480408 1.46791396 -0.36221958 -2.40200966 -1.09517653 2.05934658 0.28345430 0.20085438 2.42788080 2.34080395; 0.47647147 -0.06822680 -2.64355736 -3.02462734 3.00268404 2.95128295 -1.35649969 -1.55914541 -2.00984589 2.44087940 -1.65420702 2.93201213 1.27083502 -0.51378931 -0.23123227 -2.38820952 0.17065986 1.87425959; -2.04109871 -0.69664722 -3.06097865 2.74600962 1.52256799 -3.07447584 2.89906422 2.44651366 -1.42971490 -2.62138012 1.48464566 2.78449651 0.12444742 -1.68192091 0.05919067 -1.33905167 -1.15219846 1.37937419; 2.27105804 3.12432862 2.00404963 -1.41143735 -1.61595085 -3.03428743 0.32719374 2.23960659 -1.43354894 -1.66694175 -3.01677913 0.88864784 -0.30386500 1.68723781 2.74217155 3.09730272 2.19715402 0.15119456];
r = 0.90000000;

p1i = [0;-2;0];
p2i = [0;-2;2];
p3i = [0;-4;2];
p4i = [0;-4;4];
p5i = [0;-6;4];
p6i = [0;-6;2];

S1 = S(:,1);
S2 = S(:,2);
S3 = S(:,3);
S4 = S(:,4);
S5 = S(:,5);
S6 = S(:,6);

i = 1;
[~,x]=size(theta);
c = zeros(1,x);
n = zeros(1,28);

while i < (x+1)
thetac = theta(:,i);
Te = expm(ssV(S1,thetac(1)))*expm(ssV(S2,thetac(2)))*expm(ssV(S3,thetac(3)))*expm(ssV(S4,thetac(4)))*expm(ssV(S5,thetac(5)))*expm(ssV(S6,thetac(6)))*M;
pe = Te(1:3,4);
pb = [0;0;0];
p1 = p1i;

M2 = [eye(3) p2i; 0 0 0 1];
M3 = [eye(3) p3i; 0 0 0 1];
M4 = [eye(3) p4i; 0 0 0 1];
M5 = [eye(3) p5i; 0 0 0 1];
M6 = [eye(3) p6i; 0 0 0 1];

T2 = expm(ssV(S1,thetac(1)))*M2;
T3 = expm(ssV(S1,thetac(1)))*expm(ssV(S2,thetac(2)))*M3;
T4 = expm(ssV(S1,thetac(1)))*expm(ssV(S2,thetac(2)))*expm(ssV(S3,thetac(3)))*M4;
T5 = expm(ssV(S1,thetac(1)))*expm(ssV(S2,thetac(2)))*expm(ssV(S3,thetac(3)))*expm(ssV(S4,thetac(4)))*M5;
T6 = expm(ssV(S1,thetac(1)))*expm(ssV(S2,thetac(2)))*expm(ssV(S3,thetac(3)))*expm(ssV(S4,thetac(4)))*expm(ssV(S5,thetac(5)))*M6;

p2 = T2(1:3,4);
p3 = T3(1:3,4);
p4 = T4(1:3,4);
p5 = T5(1:3,4);
p6 = T6(1:3,4);


n(1) = norm(pb-p1);
n(2) = norm(pb-p2);
n(3) = norm(pb-p3);
n(4) = norm(pb-p4);
n(5) = norm(pb-p5);
n(6) = norm(pb-p6);
n(7) = norm(pb-pe);
n(8) = norm(p1-p2);
n(9) = norm(p1-p3);
n(10) = norm(p1-p4);
n(11) = norm(p1-p5);
n(12) = norm(p1-p6);
n(13) = norm(p1-pe);
n(14) = norm(p2-p3);
n(15) = norm(p2-p4);
n(16) = norm(p2-p5);
n(17) = norm(p2-p6);
n(18) = norm(p2-pe);
n(19) = norm(p3-p4);
n(20) = norm(p3-p5);
n(21) = norm(p3-p6);
n(22) = norm(p3-pe);
n(23) = norm(p4-p5);
n(24) = norm(p4-p6);
n(25) = norm(p4-pe);
n(26) = norm(p5-p6);
n(27) = norm(p5-pe);
n(28) = norm(p6-pe);

min_n = min(n);
d = min_n-r-r;
if d < 0
        c(i) = 1;
    else
        c(i) = 0;
end
i = i + 1;
end

disp(mat2str(c,4))